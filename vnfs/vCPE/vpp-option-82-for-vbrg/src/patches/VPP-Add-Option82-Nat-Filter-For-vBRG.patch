--- vpp/src/plugins/snat/out2in.c	2017-11-17 09:23:02.512416704 -0800
+++ out2in_new.c	2017-11-17 09:10:09.791427246 -0800
@@ -1,3 +1,4 @@
+
 /*
  * Copyright (c) 2016 Cisco and/or its affiliates.
  * Licensed under the Apache License, Version 2.0 (the "License");
@@ -648,6 +649,26 @@
   n_left_from = frame->n_vectors;
   next_index = node->cached_next_index;
 
+  //FOR BRG
+  ip4_address_t * sdnc_addr = malloc(4);
+  char line_input[128];
+  char * path = "/opt/config/ip.txt";
+  FILE * f = fopen(path, "r");
+  if (f != NULL){
+
+  while (fgets(line_input, 128, f) != NULL){
+    if (!strcmp(strtok(line_input, " "),"sdnc_ip:")){
+      char * ip = strtok(NULL, " ");
+      char * num = strtok(ip, ".");
+      sdnc_addr->data[0] = atoi(num);
+      for (int i = 1; i < 4; i ++){
+        num = strtok(NULL, ".");
+        sdnc_addr->data[i] = atoi(num);
+      }
+    }
+  }
+  } fclose(f);
+
   while (n_left_from > 0)
     {
       u32 n_left_to_next;
@@ -723,6 +744,13 @@
 
           proto0 = ip_proto_to_snat_proto (ip0->protocol);
 
+          //for BRG
+          if (PREDICT_TRUE (ip0->src_address.data_u32 != sdnc_addr->data_u32))
+            {
+              next0 = SNAT_OUT2IN_NEXT_LOOKUP;
+              goto trace0;
+            }
+
           if (PREDICT_FALSE (proto0 == ~0))
               goto trace0;
 
@@ -858,6 +886,13 @@
 
           proto1 = ip_proto_to_snat_proto (ip1->protocol);
 
+	  //for BRG
+          if (PREDICT_TRUE (ip1->src_address.data_u32 != sdnc_addr->data_u32))
+            {
+              next1 = SNAT_OUT2IN_NEXT_LOOKUP;
+              goto trace1;
+            }
+
           if (PREDICT_FALSE (proto1 == ~0))
               goto trace1;
 
@@ -1017,6 +1052,13 @@
 
           proto0 = ip_proto_to_snat_proto (ip0->protocol);
 
+	  //for BRG
+          if (PREDICT_TRUE (ip0->src_address.data_u32 != sdnc_addr->data_u32))
+            {
+              next0 = SNAT_OUT2IN_NEXT_LOOKUP;
+              goto trace00;
+            }
+
           if (PREDICT_FALSE (proto0 == ~0))
               goto trace00;
 
